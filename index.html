<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MULE TECH | Premium Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden { display: none; }
        #wheel-container { position: relative; width: 300px; height: 300px; margin: 10px auto; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; border: 5px solid #1E40AF; transition: transform 5s cubic-bezier(0.15, 0, 0.15, 1); }
        .v-input { width: 100%; padding: 12px; border: 2px solid #3b82f6; border-radius: 10px; outline: none; background: #f8fafc; font-size: 13px; }
        .gold-header { color: #FFD700; font-weight: 900; font-size: 2.2rem; text-transform: uppercase; text-align: center; text-shadow: 2px 2px #000; }
        .pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid #ef4444; z-index: 20; }
        .btn-link { background: #10b981; color: white; padding: 12px 25px; border-radius: 10px; font-weight: bold; display: inline-block; margin-bottom: 10px; width: 100%; text-align: center; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-2 font-sans">

    <div class="max-w-md w-full bg-white rounded-[2rem] shadow-2xl p-5 border-t-[8px] border-blue-700">
        <div class="text-center mb-4">
            <h1 class="gold-header">MULE TECH</h1>
        </div>

        <div id="auth-page" class="space-y-4">
            <h2 id="auth-title" class="font-bold text-center text-slate-700">á‹­áŒá‰¡ (Login)</h2>
            <div class="space-y-2">
                <input type="email" id="auth-email" placeholder="áŠ¢áˆœá‹­áˆ (Email) *" class="v-input">
                <input type="password" id="auth-password" placeholder="á‹¨á‹­áˆˆá á‰ƒáˆ (Password) *" class="v-input">
            </div>
            <button id="auth-btn" class="w-full bg-blue-700 text-white py-3 rounded-xl font-bold">áŒá‰£</button>
            <div class="flex items-center my-2">
                <div class="flex-grow border-t border-gray-300"></div>
                <span class="px-2 text-gray-400 text-xs">á‹ˆá‹­áˆ</span>
                <div class="flex-grow border-t border-gray-300"></div>
            </div>
            <button id="google-btn" class="w-full bg-white border-2 border-slate-200 text-slate-700 py-3 rounded-xl font-bold flex items-center justify-center gap-2">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="20"> á‰  Google á‹­á‰€áŒ¥áˆ‰
            </button>
            <p class="text-center text-xs text-blue-600 cursor-pointer" id="toggle-auth">áŠ á‹²áˆµ áŠ áŠ«á‹áŠ•á‰µ áˆ˜áŠ­áˆá‰» (Sign Up)</p>
        </div>

        <div id="page1" class="hidden space-y-3">
            <h2 class="font-bold text-center text-slate-700 text-sm">ğŸ‘¤ á‹¨áŒáˆ áˆ˜áˆ¨áŒƒá‹áŠ• á‹«áˆµáŒˆá‰¡</h2>
            <div class="space-y-2 max-h-[50vh] overflow-y-auto px-1">
                <input type="text" id="fname" placeholder="á‹¨áˆ˜áŒ€áˆ˜áˆªá‹« áˆµáˆ *" class="v-input">
                <input type="text" id="mname" placeholder="á‹¨áŠ á‰£á‰µ áˆµáˆ *" class="v-input">
                <input type="text" id="lname" placeholder="á‹¨áŠ á‹«á‰µ áˆµáˆ *" class="v-input">
                <select id="gender" class="v-input">
                    <option value="">áŒ¾á‰³ á‹­áˆáˆ¨áŒ¡ *</option>
                    <option value="á‹ˆáŠ•á‹µ">á‹ˆáŠ•á‹µ</option>
                    <option value="áˆ´á‰µ">áˆ´á‰µ</option>
                </select>
                <input type="text" id="phone" placeholder="á‹¨áŠ¥áˆ­áˆµá‹ áˆµáˆáŠ­ á‰áŒ¥áˆ­ *" maxlength="10" class="v-input">
                <hr>
                <p class="text-[10px] font-bold text-blue-600">á‰°áŒ áˆª (Emergency Contact)</p>
                <input type="text" id="ename" placeholder="á‹¨á‰°áŒ áˆª áˆµáˆ *" class="v-input">
                <input type="text" id="ephone" placeholder="á‹¨á‰°áŒ áˆª áˆµáˆáŠ­ á‰áŒ¥áˆ­ *" maxlength="10" class="v-input">
                <div class="flex items-center gap-2 p-2">
                    <input type="checkbox" id="rule-check"> <label class="text-[10px]">á‰  MULE TECH áˆ…áŒá‰½ á‰°áˆµáˆ›áˆá‰»áˆˆáˆá¢</label>
                </div>
            </div>
            <button onclick="checkInfoAndNav()" class="w-full bg-blue-700 text-white py-3 rounded-xl font-bold">á‰€áŒ¥áˆ â¡ï¸</button>
        </div>

        <div id="page2" class="hidden text-center">
            <h2 class="font-bold text-blue-800 text-sm mb-2">ğŸ¡ áŠ¥á‹µáˆá‹áŠ• á‹­áˆáŠ­áˆ©</h2>
            <div id="wheel-container"><div class="pointer"></div><canvas id="wheel"></canvas></div>
            <div id="spin-result-box" class="hidden mt-4 space-y-3 bg-blue-50 p-4 rounded-xl border border-blue-200">
                <input type="text" id="user-spin-input" class="v-input text-center font-bold text-blue-900 border-blue-500" readonly>
                <div id="action-links" class="mt-2">
                    <a id="tg-btn" href="https://t.me/muletechreact" target="_blank" class="btn-link hidden">Telegram Link</a>
                    <a id="yt-btn" href="https://youtube.com/@muletechreact" target="_blank" class="btn-link hidden">YouTube Link</a>
                </div>
                <button id="final-btn" onclick="handleSpinResult()" class="w-full bg-green-600 text-white py-3 rounded-xl font-bold">áŠ áˆ¨áŒ‹áŒáŒ¥áŠ“ á‰€áŒ¥áˆ</button>
            </div>
            <button id="spin-btn" onclick="spinNow()" class="w-full bg-blue-700 text-white py-3 rounded-xl font-bold">áŠ áˆ½áŠ¨áˆ­áŠ­áˆ­ (SPIN) ğŸŒ€</button>
        </div>

        <div id="page3" class="hidden">
            <h2 class="text-center font-bold text-blue-900 mb-4">áŠ®áˆ­áˆµ á‹­áˆáˆ¨áŒ¡</h2>
            <select id="course-dropdown" onchange="document.getElementById('to-pay').classList.remove('hidden')" class="v-input border-blue-400 bg-blue-50">
                <option value="">-- áŠ®áˆ­áˆµ á‹­áˆáˆ¨áŒ¡ --</option>
                <option value="Video Editing">Video Editing - 400 ETB</option>
                <option value="Graphics Design">Graphics Design - 400 ETB</option>
                <option value="Free Internet Config">Free Internet Config - 400 ETB</option>
                <option value="Social Media Management">Social Media Management - 500 ETB</option>
            </select>
            <button id="to-pay" onclick="nav(3, 4)" class="hidden w-full bg-orange-500 text-white py-3 rounded-xl font-bold mt-6">á‰€áŒ¥áˆ â¡ï¸</button>
        </div>

        <div id="page4" class="hidden space-y-4">
            <h2 class="text-center font-bold text-blue-900">á‹¨áŠ­áá‹« áŠ áˆ›áˆ«áŒ­</h2>
            <select id="bank-selector" class="v-input border-blue-600">
                <option value="">-- á‰£áŠ•áŠ­ á‹­áˆáˆ¨áŒ¡ --</option>
                <option value="Telebirr - 0927275152">Telebirr (0927275152)</option>
                <option value="CBE - 1000745084773">CBE (1000745084773)</option>
            </select>
            <button onclick="generateID()" class="w-full bg-blue-700 text-white py-3 rounded-xl font-bold">áŠ áˆ¨áŒ‹áŒáŒ¥ ğŸ†”</button>
        </div>

        <div id="page5" class="hidden text-center space-y-4">
            <div class="bg-green-50 p-6 rounded-3xl border-2 border-dashed border-green-500">
                <p class="text-xs text-green-700 mb-2">á‹¨áŠ¥áˆ­áˆµá‹ á‹¨áŠ­áá‹« áˆ˜áˆˆá‹« (ID)</p>
                <h3 id="final-id" class="text-3xl font-black text-green-800 tracking-widest"></h3>
            </div>
            <button onclick="location.reload()" class="w-full bg-green-600 text-white py-4 rounded-xl font-bold">áŒ¨áˆ­áˆ»áˆˆáˆ ğŸš€</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB3GiwKlwZtlpefj_PbDRUffKYqHzvPK2E",
            authDomain: "mule-yech.firebaseapp.com",
            projectId: "mule-yech",
            storageBucket: "mule-yech.firebasestorage.app",
            messagingSenderId: "671751802597",
            appId: "1:671751802597:web:b3c818d5459e4a62654e0c"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();
        let isLogin = true;

        document.getElementById('toggle-auth').onclick = () => {
            isLogin = !isLogin;
            document.getElementById('auth-title').innerText = isLogin ? "á‹­áŒá‰¡ (Login)" : "á‹­áˆ˜á‹áŒˆá‰¡ (Sign Up)";
            document.getElementById('auth-btn').innerText = isLogin ? "áŒá‰£" : "á‰°áˆ˜á‹áŒˆá‰¥";
            document.getElementById('toggle-auth').innerText = isLogin ? "áŠ á‹²áˆµ áŠ áŠ«á‹áŠ•á‰µ áˆ˜áŠ­áˆá‰» (Sign Up)" : "áŠ áŠ«á‹áŠ•á‰µ áŠ áˆˆá‹á‰µ? á‹­áŒá‰¡";
        };

        document.getElementById('auth-btn').onclick = async () => {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            try {
                if (isLogin) { await signInWithEmailAndPassword(auth, email, password); }
                else { await createUserWithEmailAndPassword(auth, email, password); }
                showPersonalPage();
            } catch (err) { alert("Error: " + err.message); }
        };

        document.getElementById('google-btn').onclick = async () => {
            try { await signInWithPopup(auth, provider); showPersonalPage(); }
            catch (err) { alert("Google Error: " + err.message); }
        };

        function showPersonalPage() {
            document.getElementById('auth-page').classList.add('hidden');
            document.getElementById('page1').classList.remove('hidden');
        }
    </script>

    <script>
        const BOT_TOKEN = "8225238440:AAGXXD5ph0tGdk96tE6bD-TxEJiwwTWlnw4";
        const CHAT_ID = "1312047180";

        let spinResult = "";
        const mainCourses = ["Video Editing", "Graphics Design", "Free Internet Config", "Social Media Management"];
        const items = ["Subscribe YouTube", "Video Editing", "Subscribe YouTube", "Join Telegram", "Subscribe YouTube", "Graphics Design", "Subscribe YouTube", "Join Telegram", "Subscribe YouTube", "Free Internet Config", "Subscribe YouTube", "Join Telegram", "Subscribe YouTube", "Social Media Management", "Subscribe YouTube", "Join Telegram"];
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');

        function drawWheel() {
            const arc = (Math.PI * 2) / items.length;
            canvas.width = 300; canvas.height = 300;
            items.forEach((item, i) => {
                ctx.beginPath();
                ctx.fillStyle = i % 2 === 0 ? '#1E40AF' : '#3B82F6';
                ctx.moveTo(150, 150);
                ctx.arc(150, 150, 145, i * arc, (i + 1) * arc);
                ctx.fill();
                ctx.save(); ctx.translate(150, 150); ctx.rotate(i * arc + arc / 2);
                ctx.fillStyle = "white"; ctx.font = "bold 8px Arial"; ctx.fillText(item, 50, 5); ctx.restore();
            });
        }
        drawWheel();

        function nav(f, t) {
            document.querySelectorAll('[id^="page"]').forEach(p => p.classList.add('hidden'));
            document.getElementById('page'+t).classList.remove('hidden');
        }

        function checkInfoAndNav() {
            const fields = ['fname', 'mname', 'phone'];
            for(let f of fields) { if(!document.getElementById(f).value) return alert("áŠ¥á‰£áŠ­á‹ áŠ áˆµáˆáˆ‹áŒŠ áˆ˜áˆ¨áŒƒá‹á‰½áŠ• á‹­áˆ™áˆ‰!"); }
            if(!document.getElementById('rule-check').checked) return alert("á‰ áˆ…áŒá‰¹ áˆ˜áˆµáˆ›áˆ›á‰µá‹áŠ• á‹«áˆ¨áŒ‹áŒáŒ¡!");
            sendToTelegram("ğŸ“ New Info Registered"); // Send info immediately
            nav(1, 2);
        }

        function spinNow() {
            const btn = document.getElementById('spin-btn');
            btn.disabled = true;
            const deg = 3600 + Math.random() * 3600;
            canvas.style.transform = `rotate(${deg}deg)`;
            setTimeout(() => {
                const actualDeg = deg % 360;
                const idx = items.length - 1 - Math.floor(actualDeg / (360 / items.length));
                spinResult = items[idx];
                document.getElementById('user-spin-input').value = spinResult;
                document.getElementById('spin-result-box').classList.remove('hidden');
                btn.classList.add('hidden');
                if(mainCourses.includes(spinResult)) {
                    document.getElementById('winner-msg')?.classList.remove('hidden');
                } else {
                    if(spinResult === "Join Telegram") document.getElementById('tg-btn').classList.remove('hidden');
                    if(spinResult === "Subscribe YouTube") document.getElementById('yt-btn').classList.remove('hidden');
                }
                sendToTelegram("ğŸ¡ Wheel Spun");
            }, 5000);
        }

        function handleSpinResult() {
            if(mainCourses.includes(spinResult)) {
                sendToTelegram("ğŸ† FREE COURSE WINNER!");
                alert("áŠ¥áŠ•áŠ³áŠ• á‹°áˆµ áŠ áˆˆáˆ…! áˆ˜áˆ¨áŒƒáˆ… á‰°áˆáŠ³áˆ!");
                location.reload();
            } else { nav(2, 3); }
        }

        function generateID() {
            if(!document.getElementById('bank-selector').value) return alert("á‰£áŠ•áŠ­ á‹­áˆáˆ¨áŒ¡!");
            const id = "MT-" + Math.floor(10000 + Math.random() * 90000);
            document.getElementById('final-id').innerText = id;
            sendToTelegram(`ğŸ’° PAYMENT SUBMITTED - ID: ${id}`);
            nav(4, 5);
        }

        function sendToTelegram(status) {
            const report = `ğŸš€ **MULE-TECH REPORT**\n` +
                `---------------------------\n` +
                `ğŸ“Œ **Status:** ${status}\n` +
                `ğŸ‘¤ **Name:** ${document.getElementById('fname').value} ${document.getElementById('mname').value} ${document.getElementById('lname').value}\n` +
                `ğŸ“ **Phone:** ${document.getElementById('phone').value}\n` +
                `ğŸš» **Gender:** ${document.getElementById('gender').value}\n` +
                `ğŸš¨ **Emergency:** ${document.getElementById('ename').value} (${document.getElementById('ephone').value})\n` +
                `ğŸ¡ **Spin Result:** ${spinResult || 'N/A'}\n` +
                `ğŸ“š **Course:** ${document.getElementById('course-dropdown').value || 'Pending'}\n` +
                `ğŸ’³ **Bank:** ${document.getElementById('bank-selector').value || 'N/A'}\n` +
                `---------------------------`;

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CHAT_ID, text: report, parse_mode: 'Markdown' })
            });
        }
    </script>
</body>
</html>
